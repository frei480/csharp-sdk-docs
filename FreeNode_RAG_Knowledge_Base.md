# База знаний по классу FreeNode для RAG-системы

## Общая информация

Класс `FreeNode` в T-Flex CAD API представляет собой узел с абсолютными координатами в системе координат модели. Это один из ключевых классов для создания геометрических объектов в 2D-пространстве.

### Назначение класса
- Создание узлов с фиксированными координатами
- Определение точек привязки для других геометрических объектов
- Формирование базиса для построения линий, окружностей и других фигур

### Иерархия наследования
```
System.Object
  TFlex.Model.ModelObject
    TFlex.Model.Model2D.Object2D
      TFlex.Model.Model2D.Node
        TFlex.Model.Model2D.FreeNode
```

## Конструкторы

### 1. FreeNode(Document)
Конструктор по умолчанию. Координаты установлены в значение 0,0.

**Параметры:**
- `document` (Document) - Документ объекта

**Особенности:**
- Создает узел в начале координат
- Используется для последующего изменения координат
- Удобен для временных узлов

### 2. FreeNode(Document, Parameter, Parameter)
Конструктор, задающий координаты x,y в системе координат модели, без учёта масштаба текущей страницы.

**Параметры:**
- `document` (Document) - Документ объекта
- `x` (Parameter) - Координата X
- `y` (Parameter) - Координата Y

**Особенности:**
- Создает узел с заданными координатами
- Является наиболее часто используемым конструктором
- Координаты задаются в абсолютной системе координат

## Свойства класса

### Основные свойства

#### X (Parameter)
Значение координаты X узла

#### Y (Parameter)
Значение координаты Y узла

#### AbsX (double)
Координата X в системе координат модели (без учёта масштаба страницы)

#### AbsY (double)
Координата Y в системе координат модели (без учёта масштаба страницы)

#### Coordinates (Point2D)
Координаты узла в системе координат модели (без учёта масштаба страницы)

#### SubType (NodeSubType)
Подтип способа построения узла (всегда FreeNode)

### Свойства отображения

#### Color (int)
Цвет объекта

#### Layer (int)
Слой, на котором размещается объект

#### Level (int)
Уровень объекта

#### Visible (bool)
Является ли объект видимым

## Методы класса

Класс `FreeNode` наследует методы от классов `Node`, `Object2D` и `ModelObject`. Основные унаследованные методы включают:

### Методы отображения
- `SetDefaults()` - Установка параметров узлов по умолчанию
- `CreateDefaultStyle()` - Создание стиля по умолчанию

### Геометрические методы
- `DistanceTo(Node other)` - Расстояние до другого узла
- `DistanceTo(Point2D point)` - Расстояние до точки
- `Transform(Matrix2D transform)` - Применение преобразования

### Методы управления
- `MoveTo(double x, double y)` - Перемещение узла в новые координаты
- `Offset(double dx, double dy)` - Смещение узла

## Практическое применение

### Типичные сценарии использования

1. **Создание точек привязки**
   - Определение ключевых точек конструкции
   - Создание узлов для последующего построения линий
   - Формирование базиса для параметрических построений

2. **Построение геометрических фигур**
   - Углы прямоугольников и многоугольников
   - Центры окружностей и дуг
   - Контрольные точки кривых

3. **Создание систем координат**
   - Определение начала координат
   - Создание узлов для осей
   - Формирование сеток привязки

### Интеграция с другими объектами

1. **С линиями изображения (ConstructionOutline)**
   - Определение начальных и конечных точек
   - Создание узлов привязки для сложных линий

2. **С линиями построения (Construction)**
   - Центральные узлы для окружностей
   - Контрольные точки для дуг и эллипсов
   - Узлы для определения прямых линий

3. **С профилями (Profile)**
   - Узлы для определения контуров
   - Точки привязки для параметрических профилей

## Примеры кода

### Базовое создание узла
```csharp
Document document = TFlex.Application.ActiveDocument;
document.BeginChanges("Создание узла");

FreeNode node = new FreeNode(document, 100, 100);

document.EndChanges();
```

### Работа со свойствами узла
```csharp
node.X.Value = 150;  // Изменение координаты X
node.Y.Value = 200;  // Изменение координаты Y
node.Color = 255;    // Установка красного цвета
node.Layer = 2;      // Установка слоя 2
node.Visible = true; // Установка видимости
```

### Создание узла по умолчанию с последующим изменением
```csharp
Document document = TFlex.Application.ActiveDocument;
document.BeginChanges("Создание узла");

FreeNode node = new FreeNode(document);
node.X.Value = 100;
node.Y.Value = 100;

document.EndChanges();
```

## Рекомендации по использованию

### Лучшие практики

1. **Всегда используйте блоки изменений**
   ```csharp
   document.BeginChanges("Описание");
   // Операции с объектами
   document.EndChanges();
   ```

2. **Проверяйте существование документа**
   ```csharp
   if (TFlex.Application.ActiveDocument != null)
   {
       // Работа с документом
   }
   ```

3. **Используйте осмысленные имена переменных**
   - `centerNode` вместо `node1`
   - `topLeftCorner` вместо `fn`

4. **Управляйте ресурсами**
   - Не создавайте лишние узлы
   - Переиспользуйте существующие объекты при возможности

### Распространенные ошибки

1. **Отсутствие блоков изменений**
   - Приводит к некорректной работе с документом
   - Может вызвать исключения

2. **Некорректные координаты узлов**
   - NaN или бесконечные значения
   - Координаты вне допустимого диапазона

3. **Неправильное использование типов узлов**
   - Использование FreeNode там, где нужен ConstructionNode
   - Несоответствие типов узлов для конкретных операций

## Производительность

### Оптимизация создания множества узлов
```csharp
document.BeginChanges("Создание множества узлов");
try
{
    List<FreeNode> nodes = new List<FreeNode>();
    for (int i = 0; i < 100; i++)
    {
        FreeNode node = new FreeNode(document, i * 10, 100);
        nodes.Add(node);
    }
    document.EndChanges();
}
catch
{
    document.CancelChanges();
    throw;
}
```

### Рекомендации по производительности
- Группируйте операции в одном блоке изменений
- Используйте предварительное создание списков узлов
- Избегайте частых операций обновления экрана
- Удаляйте временные объекты после использования

## Совместимость и ограничения

### Ограничения API
- Узлы имеют ограничения по диапазону координат
- Некоторые комбинации геометрии могут быть неподдерживаемыми
- Ограниченная поддержка 3D-геометрии

### Совместимость с версиями
- Версия API: 17.1.20.0
- Совместимость с T-FLEX CAD 17.x

## Дополнительные ресурсы

### Связанные классы
- `Node` - базовый класс узлов
- `ConstructionNode` - узлы на линиях построения
- `OutlineNode` - узлы на линиях изображения
- `Construction` - линии построения
- `Outline` - линии изображения

### Полезные перечисления
- `NodeSubType` - типы узлов
- `StandardWorkplane` - стандартные рабочие плоскости

Эта база знаний предоставляет исчерпывающую информацию о классе `FreeNode` для использования в RAG-системе, включая все аспекты его применения, интеграции и оптимизации.