

Руководство по T-FLEX CAD Open API

# Профиль, построенный по эскизу  
        
    
    public static void SketchProfile()
    {
        Document document = TFlex.Application.ActiveDocument;//Получение активного документа
        document.BeginChanges("Профиль, построенный по эскизу");//Открытие блока изменений документа
    
        //создание узлов        
        FreeNode fn1 = new FreeNode(document, 10, 10);
        FreeNode fn2 = new FreeNode(document, 40, 30);
        FreeNode fn3 = new FreeNode(document, 70, 10);
    
        //создание линий, проходящих через эти узлы        
        ConstructionOutline l1 = new ConstructionOutline(document, fn1, fn2);
        ConstructionOutline l2 = new ConstructionOutline(document, fn2, fn3);
        ConstructionOutline l3 = new ConstructionOutline(document, fn3, fn1);
    
        //рабочая плоскость(вид слева), на которой будет построен профиль        
        StandardWorkplane swp = new StandardWorkplane(document, StandardWorkplane.StandardType.Left); 
        SketchProfile sp = new SketchProfile(document);
        sp.WorkSurface = swp;
    
        document.EndChanges();//Закрытие блока изменений документа
    }