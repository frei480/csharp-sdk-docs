

Руководство по T-FLEX CAD Open API

# Путь трубопровода  
  
---  
      
    
    public static void CreatePipePath3D()
    {
        Document document = TFlex.Application.ActiveDocument;
        document.BeginChanges("Create new PipePath3D");
    
        PipePath3D pipePath3D = new PipePath3D( document );
        /*first segment*/
        PipePath3D.SegmentSplineToPoint spline = pipePath3D.AddBackSegment<PipePath3D.SegmentSplineToPoint>( SegmentPipePathType.SplineToPoint );
        PipePath3D.PointSplineToPoint point = spline.AddEndPoint();
        point.Position = new Point3D( 0, 10, 20 );
    
        point = spline.AddEndPoint();
        point.Position = new Point3D( 0, 50, 20 );
    
        point = spline.AddEndPoint();
        point.Position = new Point3D( 0, 50, 60 );
    
        point = spline.AddEndPoint();
    
        CoordinateNode3D node3D = new CoordinateNode3D( document );
        node3D.X = new Parameter( new Variable( document, "VarX", 20 ) );
        node3D.Y = new Parameter( new Variable( document, "VarY", 80 ) );
        node3D.Z = new Parameter( new Variable( document, "VarZ", 90 ) );
    
        /*attach point path3D to node3D*/
        point.SetPosition( node3D.Geometry.Point );
        /*add offset*/
        point.EditPosition( Coordinate.X, new Parameter( new Variable( document, "OffsetX", -10 ) ), true );
    
        /*second segment*/
        PipePath3D.SegmentPolyline pline = pipePath3D.AddBackSegment<PipePath3D.SegmentPolyline>( SegmentPipePathType.Polyline );
        pline.Radius = new Parameter( 45 );
    
        PipePath3D.PointPolyline ppoint = pline.AddEndPoint();
        ppoint.Position = new Point3D( 120, 50, 20 );
    
        ppoint = pline.AddEndPoint();
        ppoint.Position = new Point3D( 120, 80, 20 );
    
        ppoint = pline.AddEndPoint();
        ppoint.Position = new Point3D( 120, 100, 60 );
    
        ppoint = pline.AddEndPoint();
        ppoint.Position = new Point3D( 140, 150, 80 );
    
        /*Creates smooth sections of intersegment*/
        pipePath3D.Smoothness = true;
        pipePath3D.MakeSmoothness();
    
        document.EndChanges();
    }