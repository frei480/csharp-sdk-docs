

Руководство по T-FLEX CAD Open API

# 3D фрагменты  
```csharp
    public static void FragmentLCS(string pathFragment, PointsLCS lcs)
    {
        Document document = TFlex.Application.ActiveDocument;//Получение активного документа
        document.BeginChanges("");
    
        Fragment3D fr = new Fragment3D(pathFragment, document);
        fr.FixByFragmentLCS(lcs.Name, lcs); //привязка фрагмента к системе координат(название системы координат, сама система)
    
        document.EndChanges();//Закрытие блока изменений документа
    }
    
    
```    
```csharp
public static void FragmentVariables(string pathFragment)
{
	Document document = TFlex.Application.ActiveDocument;//Получение активного документа
	document.BeginChanges("");

	Fragment3D fragment = new Fragment3D(pathFragment, document);
	foreach(FragmentVariableValue v in fragment.GetVariables())//цикл по переменным фрагмента
	{
		if(v.Name == "D" && v.IsReal)//находим переменную "D" 
		{
			v.RealValue = 100;//устанавливаем значение
		}
	}

	document.EndChanges();//Закрытие блока изменений документа
}

```
```csharp
public static void FragmentOpenPart(string pathFragment)
{
	Document document = TFlex.Application.ActiveDocument;//Получение активного документа
	document.BeginChanges("");

	Fragment3D fr = new Fragment3D(pathFragment, document);
	fr.OpenPart(); //деталировка

	document.EndChanges();//Закрытие блока изменений документа
}

```
    
```csharp
//Пример создание 3D фрагментов методом планировок
public static void FragmentMethodPlan(WorkPlane onPointsWorkplane, string pathFragment)
{
	Document document = TFlex.Application.ActiveDocument;//Получение активного документа
	document.BeginChanges("");

	Fragment f = new Fragment(document, pathFragment);//2D-фрагмент, имеющий 3D реализацию
	f.Page = onPointsWorkplane.Page;//привязка фрагмента к странице плоскости
	Fragment3D fr = new Fragment3D(f, onPointsWorkplane);//3D-фрагмент на основе 2D-фрагмента и плоскости

	document.EndChanges();//Закрытие блока изменений документа
}
```