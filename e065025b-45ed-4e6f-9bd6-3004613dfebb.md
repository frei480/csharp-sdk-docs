

Руководство по T-FLEX CAD Open API

# Параллельная плоскость  
  
---  
      
    
    public static void ParallelPlaneWorkplane()
    {
        Document document = TFlex.Application.ActiveDocument;//Получение активного документа
        document.BeginChanges("Построение параллельной плоскости");//Открытие блока изменений документа
    
        OnPointsWorkplane onPointsWorkplane = new OnPointsWorkplane(document);//создаем объект
        onPointsWorkplane.Name = "A";
    
        //построение узлов
        CoordinateNode3D node1 = new CoordinateNode3D(document); 
        node1.X = 10; node1.Y = 20; node1.Z = 70;
    
        CoordinateNode3D node2 = new CoordinateNode3D(document); 
        node2.X = 10; node2.Y = 10; node2.Z = 70;
    
        CoordinateNode3D node3 = new CoordinateNode3D(document); 
        node3.X = 20; node3.Y = 10; node3.Z = 70;
    
        //построение плоскости A по 3 точкам
        onPointsWorkplane.FirstPointOnWorkplane = node1.Geometry.Point;
        onPointsWorkplane.SecondPointOnWorkplane = node2.Geometry.Point;
        onPointsWorkplane.ThirdPointOnWorkplane = node3.Geometry.Point;
    
        //рабочая плоскость параллельная плоскости
        ParallelPlaneWorkplane parallelPlaneWorkplane = new ParallelPlaneWorkplane(document);
        parallelPlaneWorkplane.Name = "B || A";
        parallelPlaneWorkplane.Color = 100;
        parallelPlaneWorkplane.Offset = 100;
        parallelPlaneWorkplane.BasePlane =onPointsWorkplane.Geometry.Plane;
    
        document.EndChanges();//Закрытие блока изменений документа
    }