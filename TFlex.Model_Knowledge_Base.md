# База знаний по классам в пространстве имён TFlex.Model

## Document

**Описание:** Центральный класс, представляющий документ T-Flex CAD, содержащий 3D-модель, 2D-чертежи и связанные данные.

**Основные свойства:**
- `ActivePage`: текущая активная страница
- `Selection`: выделенные объекты
- `Properties`: свойства документа (единицы измерения, параметры)
- `ActiveView`: активный вид

**Основные методы:**
- `BeginChanges(string description)`: начало блока изменений
- `EndChanges()`: завершение блока изменений
- `GetObjects()`: получение всех объектов модели
- `GetObjectById(int id)`: получение объекта по ID
- `GetObjectByName(string name)`: получение объекта по имени
- `DeleteObjects(ObjectArray objects, DeleteOptions options)`: удаление объектов
- `Save()`: сохранение документа
- `Close()`: закрытие документа

**События:**
- `DocumentOpened`: открытие документа
- `DocumentClosed`: закрытие документа
- `ObjectCreated`: создание объекта
- `ObjectDeleted`: удаление объекта
- `ObjectModified`: изменение объекта

**Использование:** Для всех операций с документом, управления моделью и чертежами.

## ModelObject

**Описание:** Базовый абстрактный класс для всех объектов в модели T-Flex CAD.

**Основные свойства:**
- `Id`: int - уникальный идентификатор объекта
- `Name`: string - имя объекта
- `GroupType`: ObjectType - тип объекта
- `Visible`: bool - видимость объекта

**Использование:** Для работы с любыми объектами модели через общий интерфейс.

## Fragment3D

**Описание:** Класс представляет внешнюю ссылку на 3D-модель (фрагмент).

**Основные свойства:**
- `FullFilePath`: string - полный путь к файлу фрагмента
- `FileName`: string - имя файла
- `IsLoaded`: bool - загружен ли фрагмент

**Использование:** Для работы с внешними ссылками на модели в сборках.

## ObjectArray

**Описание:** Коллекция объектов модели для групповых операций.

**Основные методы:**
- `Add(ModelObject obj)`: добавление объекта
- `Remove(ModelObject obj)`: удаление объекта
- `Count`: int - количество объектов
- `GetAt(int index)`: получение объекта по индексу

**Использование:** Для подготовки списков объектов к групповым операциям (удаление, копирование и т.д.).

## ObjectType

**Перечисление типов объектов модели:**

- `Operation` - операция моделирования (выдавливание, вращение и т.д.)
- `LCS` - локальная система координат
- `Dimension` - размер
- `Projection` - проекция
- `Fragment` - фрагмент
- `Sketch` - эскиз
- `Variable` - переменная
- `Parameter` - параметр
- `Construction` - линия построения

**Использование:** Для классификации и фильтрации объектов модели.

## DeleteOptions

**Описание:** Параметры для операций удаления объектов.

**Конструктор:** `DeleteOptions(bool confirmDependencies)`

**Параметры:**
- `confirmDependencies`: bool - запрашивать подтверждение при удалении объектов с зависимостями

**Использование:** Управление поведением при удалении связанных объектов.

## Дополнительная информация

### Жизненный цикл документа
1. Создание/открытие документа
2. Присоединение плагинов (`AttachPlugin`)
3. Работа с моделью (в блоках `BeginChanges/EndChanges`)
4. Сохранение изменений
5. Отсоединение плагинов (`DetachPlugin`)
6. Закрытие документа

### Блоки изменений
- Все модификации модели должны быть в блоках `BeginChanges/EndChanges`
- Блоки могут быть вложенными
- Описание блока используется в истории операций
- При ошибке изменения откатываются автоматически

### Идентификаторы объектов
- Уникальны в пределах документа
- Не изменяются при модификациях
- Используются для поиска и ссылок
- Специальные ID: 0x30000001 - корневой объект модели

### События документа
- Подписка на события для реактивного поведения
- Обработчики получают `EventArgs` с деталями события
- Важно отписываться от событий при закрытии документа

### Работа с выделением
- `Selection` управляет выделенными объектами
- Поддерживает множественное выделение
- Используется командами для определения цели операции

### Единицы измерения
- Доступны через `document.Properties.LinearUnit`
- `CoefficientToBase` - коэффициент к базовым единицам
- Все координаты в единицах документа

### История операций
- `Undo/Redo` для отмены/повтора операций
- `CanUndo/CanRedo` для проверки возможности
- `ClearHistory` для освобождения памяти</content>
<parameter name="filePath">d:\work\T-Flex\macros\Source\TFlex.Model_Knowledge_Base.md