

Руководство по T-FLEX CAD Open API

# Выбор объекта в окне  
        
    
    using System;
    using System.Windows.Forms;
    
    using TFlex;
    using TFlex.Model;
    using TFlex.Model.Model2D;
    using TFlex.Model.Model3D;
    
    namespace NewMacroNamespace
    {
        public class NewMacroClass
        {
            public static void PickPoint()
            {
                PickPointParameters par = new PickPointParameters();
    
                //выбор только размеров
                SelectionFilter filter = new SelectionFilter();
                filter.Enable(ObjectType.Dimension);
                par.Filter = filter;
    
                par.Prompt = "Выбрать размер";
                par.MouseMove += new TFlex.PickPointMouseMove(PickPointMouseMove);//событие перемещения мыши
                PickPointResult res = TFlex.Application.PickPoint(par);//получить точку в одном из видов активного документа
    
                string mess = "Объект не выбран";
                if (res.SelectedObject != null)
                {
                    mess = string.Empty;
                    string val = string.Empty;
    
                    ObjectProperty[] arr = res.SelectedObject.GetProperties();//массив свойств выбранного объекта
                    for (int i = 0; i < arr.Length; i++)
                    {
                        switch (arr[i].Type)
                        {
                            case (ObjectPropertyType.IntProperty):
                                val = res.SelectedObject.GetIntProperty(arr[i].Name).Value.ToString();
                                break;
    
                            case (ObjectPropertyType.RealProperty):
                                val = res.SelectedObject.GetRealProperty(arr[i].Name).Value.ToString();
                                break;
    
                            case (ObjectPropertyType.TextProperty):
                                val = res.SelectedObject.GetTextProperty(arr[i].Name);
                                break;
                        }
    
                        mess += arr[i].Name + ": " + val + "\r\n";
                    }
                }
    
                MessageBox.Show(mess);
            }
    
            static public void PickPointMouseMove(Object sender, PickPointEventArgs e)
            {
            }
        }
    }