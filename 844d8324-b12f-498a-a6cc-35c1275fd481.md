

Руководство по T-FLEX CAD Open API

# Перпендикулярная плоскость  
        
    
```csharp
public static void PerpendicularToPathWorkplane(PolylineSplinePath3D polylineSplinePath3D, ModelEdge modelEdge)
{
	Document document = TFlex.Application.ActiveDocument;//получение активного документа
	document.BeginChanges("построение перпендикулярной плоскости");//открытие блока изменений документа

	OnPointsWorkplane onPointsWorkplane = new OnPointsWorkplane(document);//создаем объект
	onPointsWorkplane.Name = "a";

	//построение узлов
	CoordinateNode3D node1 = new CoordinateNode3D(document);
	node1.X = 10; node1.Y = 20; node1.Z = 70;

	CoordinateNode3D node2 = new CoordinateNode3D(document);
	node2.X = 10; node2.Y = 10; node2.Z = 70;

	CoordinateNode3D node3 = new CoordinateNode3D(document);
	node3.X = 20; node3.Y = 10; node3.Z = 70;

	//построение плоскости a по 3 точкам
	onPointsWorkplane.FirstPointOnWorkplane = node1.Geometry.Point;
	onPointsWorkplane.SecondPointOnWorkplane = node2.Geometry.Point;
	onPointsWorkplane.ThirdPointOnWorkplane = node3.Geometry.Point;

	PerpendicularToPathWorkplane p = new PerpendicularToPathWorkplane(document);
	p.Name = "p";
	p.PointOnWorkplane = node1.Geometry.Point;
	p.Location = node1.Geometry.Point;

	/*1. Плоскость перпендикулярная полилинии
	p.Path = polylineSplinePath3D.Geometry.Wire;//путь, перпендикулярно которому проходит рабочая плоскость*/

	//2. Плоскость перпендикулярная ребру 
	p.Path = modelEdge.Geometry.Wire;

	document.EndChanges();//закрытие блока изменений документа
}
```