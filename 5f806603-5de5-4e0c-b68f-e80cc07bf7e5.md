

Руководство по T-FLEX CAD Open API

# Массив по точкам  
  
---  
      
    
    using System;
    using TFlex.Model;
    using TFlex.Model.Model2D;
    using TFlex.Model.Model3D;
    
    namespace NewMacroNamespace
    {
        public class NewMacroClass
        {
            //Создание массива по точкам
            public static void NodeArrayOperation()
            {
                Document document = TFlex.Application.ActiveDocument;//Получение активного документа
    
                document.BeginChanges("Массив по точкам");//Открытие блока изменений документа
    
                // Операция, из которой надо сделать массив (в общем случае получается из контейнера операций : document.GetOperations())
                Operation operation = CreateSimpleExtrusion(document);
    
                // Узлы для массива
                CoordinateNode3D node1 = new CoordinateNode3D(document) { X = 200, Y = 200, Z = 200 };
                CoordinateNode3D node2 = new CoordinateNode3D(document) { X = 250, Y = 300, Z = 300 };
                CoordinateNode3D node3 = new CoordinateNode3D(document) { X = 200, Y = 500, Z = 200 };
    
                NodeArrayOperation nao = new NodeArrayOperation(document);
                nao.Operations.Add(operation); //добавление операции в массив
                nao.SourcePoint = node1.Geometry.Point;
    
                nao.AddTargetPoint(node2.Geometry.Point);
                nao.AddTargetPoint(node3.Geometry.Point);
    
                document.EndChanges();//Закрытие блока изменений документа
            }
    
            // Создание простого выталкивание для использования при создании массива по точкам
            private static ThickenExtrusion CreateSimpleExtrusion(Document document)
            {
                FreeNode fn1 = new FreeNode(document, 10, 10);
                FreeNode fn2 = new FreeNode(document, 40, 30);
                FreeNode fn3 = new FreeNode(document, 70, 10);
    
                ConstructionOutline l1 = new ConstructionOutline(document, fn1, fn2);
                ConstructionOutline l2 = new ConstructionOutline(document, fn2, fn3);
                ConstructionOutline l3 = new ConstructionOutline(document, fn3, fn1);
    
                StandardWorkplane swp = new StandardWorkplane(document, StandardWorkplane.StandardType.Left);
                SketchProfile sp = new SketchProfile(document);
                sp.WorkSurface = swp;
    
                var extrusion = new ThickenExtrusion(document);
                extrusion.Thickness1 = 10;
                extrusion.LengthType = ThickenExtrusion.LengthValue.AutoValue;
                extrusion.ForwardLength = 50;
                extrusion.Profile.Add(sp.Geometry.SheetContour);
                return extrusion;
            }
        }
    }