

Руководство по T-FLEX CAD Open API

# 2D фрагменты  
```csharp
public static void FragmentNodes(string pathFragment)
{
	Document document = TFlex.Application.ActiveDocument;//Получение активного документа            
	document.BeginChanges("2D фрагменты вставка по узлам");//Открытие блока изменений документа

	Fragment fragment = new Fragment(document, pathFragment);//фрагмент
	FreeNode fn1 = new FreeNode(document, 0, 180);
	fragment.SetFixingNode(1, fn1);//Установка узла привязки точки привязки фрагмента, привязанного при помощи переменных привязки

	document.EndChanges();//Закрытие блока изменений документа
}
```

```csharp
public static void FragmentFixingVector(string pathFragment)
{    
	Document document = TFlex.Application.ActiveDocument;//Получение активного документа
	document.BeginChanges("2D фрагменты вставка по вектору привязки");//Открытие блока изменений документа

	Fragment fragment = new Fragment(document, pathFragment);            
	FixingVector fv = new FixingVector(document); //вектор привязки
	fv.Name = "FixingVector";

	FreeNode fn1 = new FreeNode(document, 10, 160);
	FreeNode fn2 = new FreeNode(document, 100, 160);

	fv.StartNode = fn1;
	fv.EndNode = fn2;
	fv.Color = 200;
	//установить привязку фрагмента по вектору привязки с указанным именем
	fragment.SetFixingVectorName("FixingVector");

	document.EndChanges();//Закрытие блока изменений документа
}    
```
    
```csharp
public static void FragmentConnector(string pathFragment)
{
	Document document = TFlex.Application.ActiveDocument;//Получение активного документа
	document.BeginChanges("2D фрагменты вставка по коннектору");//Открытие блока изменений документа

	Fragment fragment = new Fragment(document, pathFragment);//фрагмент    
	FreeNode fn1 = new FreeNode(document, -100, 700);
	fragment.SetFixingNode(1, fn1);
	Connector connector = new Connector(document);//коннектор
	connector.StartNode = new FreeNode(document, -100, 700);//Начальный узел            
	connector.EndNode = new FreeNode(document, 100, 700);//Конечный узел            
	fragment.Connector = connector;//привязка созданного коннектора к фрагменту

	document.EndChanges();//Закрытие блока изменений документа
}
```
    
```csharp
public static void FragmentVariables(string pathFragment)
{
	Document document = TFlex.Application.ActiveDocument;//Получение активного документа
	document.BeginChanges("2D фрагменты");//Открытие блока изменений документа

	Fragment fragment = new Fragment(document, pathFragment);
	foreach(FragmentVariableValue v in fragment.GetVariables())//цикл по переменным фрагмента
	{
		if(v.Name == "D" && v.IsReal)//находим переменную "D" 
		{
			v.RealValue = 100;//устанавливаем значение
		}
	}

	document.EndChanges();//Закрытие блока изменений документа
}
```    
    
```csharp
public static void FragmentAction(string pathFragment)
{
	Document document = TFlex.Application.ActiveDocument;//Получение активного документа
	document.BeginChanges("действия над фрагментами");//Открытие блока изменений документа

	Fragment fragment = new Fragment(document, pathFragment);
	fragment.EditInContext();//Редактировать в контексте сборки
	fragment.Explode(true);//Раскрыть фрагмент true - с построением
	fragment.OpenPart();//деталировка

	document.EndChanges();//Закрытие блока изменений документа            
}
```