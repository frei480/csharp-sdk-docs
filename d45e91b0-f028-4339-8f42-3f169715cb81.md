

Руководство по T-FLEX CAD Open API

# Изменение документа  
    
Любые изменения документа должны производиться при открытом блоке изменения документа.

**Блок изменения документа** \- именованный набор действий по изменению модели документа. 

Этот набор действий подтверждается при закрытии блока изменения документа в случае корректности произведённых изменений. Отмена действий (Undo) производится в соответствии с блоками изменения документа. Имя блока изменения документа отображается в диалоге отмены и повтора действий. 

Для открытия блока изменения документа необходимо использовать метод [BeginChanges](M_TFlex_Model_Document_BeginChanges.md). Для временного применения действий по изменению документа без закрытия блока изменений используется метод [ApplyChanges](Overload_TFlex_Model_Document_ApplyChanges.md). Метод [EndChanges](Overload_TFlex_Model_Document_EndChanges.md) предназначен для закрытия блока изменения документа. Вызов этого метода подтверждает произведённые изменения в случае корректности произведённых изменений и отменяет все изменения в случае ошибки. Метод [CancelChanges](Overload_TFlex_Model_Document_CancelChanges.md) предназначен для того, чтобы закрыть блок изменений документа с отменой всех произведённых в нём изменений. 

Ниже приведен пример кода функции, которая меняет цвет всех штриховок документа на синий.
    
    
    private void ChangeAllAreas(Document document)
    {
        //Открываем блок изменения документа
        document.BeginChanges("Изменение цвета штриховок");
        //Перебираем все объекты штриховок
        foreach (Area area in document.GetAreas())
        {
            //Изменяем цвет на синий
            area.Color = 1;
        }
        //Закрываем блок изменения документа
        document.EndChanges();
    }
    
    
    Private Sub ChangeAllAreas(ByVal document As Document)
        'Открываем блок изменения документа
        document.BeginChanges("Изменение цвета штриховок")
        'Перебираем все объекты штриховок
        For Each area As Area In document.GetAreas()
            'Изменяем цвет на синий
            area.Color = 1
        Next
        'Закрываем блок изменения документа
        document.EndChanges()
    End Sub

В настоящее время язык не поддерживается либо пример кода отсутствует.

#### Другие ресурсы

[Общие положения о документах T-FLEX CAD](8e32df72-3613-4ebb-bdae-13e95f2057cb.md)

[Общие положения об объектах документа T-FLEX CAD](165b92c0-a86f-470f-9ac7-467b59ccf9e7.md)

[Поиск объектов модели](b77cd316-c883-4c81-aab1-f600ecdfc183.md)