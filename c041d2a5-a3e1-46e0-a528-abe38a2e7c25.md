

Руководство по T-FLEX CAD Open API

# Управление контейнером диагностики  
    
Класс контейнера диагностических сообщений [Diagnostics](T_TFlex_Model_Diagnostics.md) документа позволяет приложению, как и самой системе, выводить сообщения в окно диагностики системы. Для работы с контейнером диагностики можно воспользоваться методом [Diagnostics](P_TFlex_Model_Document_Diagnostics.md).

Ниже приведен пример, который демонстрирует возможность использования окна диагностики. Диагностическое сообщение выводится в случае, если на активной странице нет линий изображения, которая эта функция удаляет.
    
    
    private void DeleteAllOutlines(Document document)
    {
        //Переменная признака наличия или отсутствия линий изображения на странице
        bool bFound = false;
        //Создаем массив удаляемых объектов модели
        ObjectArray DelArray = new ObjectArray();
        //Перебор всех линий изображения в документе
        foreach(Object2D outline in document.GetOutlines())
        {
            //Если данная линия находится на активной странице документа
            if(outline.Page == document.ActivePage)
            {
                //Заносим её в массив
                DelArray.Add(outline);
                //Устанавливаем признак наличия линий изображения
                bFound = true;
            }
        }
        //Если в документе нет линий изображения
        if(!bFound)
        {
            //Выводим сообщение об их отсутствии в окно диагностики
            document.Diagnostics.Add(new DiagnosticsMessage(DiagnosticsMessageType.Information,"Нет линий изображения на странице"));
            //Выход из функции
            return;
        }
        //Открываем блок изменения документа
        document.BeginChanges("Удаление всех линий изображения на странице");
        //Удаляем созданный массив без вопроса об удалении зависимых элементов
        document.DeleteObjects(DelArray,new DeleteOptions(true));
        //Закрываем блок изменения документа
        document.EndChanges();
    }
    
    
    Private Sub DeleteAllOutlines(ByVal document As Document)
        'Переменная признака наличия или отсутствия линий изображения на странице
        Dim bFound As Boolean
        bFound = False
        'Создаем массив удаляемых объектов модели
        Dim DelArray As ObjectArray
        DelArray = New ObjectArray()
        'Перебор всех линий изображения в документе
        For Each outline As Object2D In document.GetOutlines()
            'Если данная линия находится на активной странице документа
            If outline.Page Is document.ActivePage Then
                'Заносим её в массив
                DelArray.Add(outline)
                'Устанавливаем признак наличия линий изображения
                bFound = True
            End If
        Next
        'Если в документе нет линий изображения
        If Not bFound Then
            'Выводим сообщение об их отсутствии в окно диагностики
            document.Diagnostics.Add(New DiagnosticsMessage(DiagnosticsMessageType.Information, "Нет линий изображения на странице"))
            'Выход из функции
            Return
        End If
        'Открываем блок изменения документа
        document.BeginChanges("Удаление всех линий изображения на странице")
        'Удаляем созданный массив без вопроса об удалении зависимых элементов
        document.DeleteObjects(DelArray, New DeleteOptions(True))
        'Закрываем блок изменения документа
        document.EndChanges()
    End Sub

В настоящее время язык не поддерживается либо пример кода отсутствует.

#### Ссылки

[ObjectArray](T_TFlex_Model_ObjectArray.md)

#### Другие ресурсы

[Общие положения о документах T-FLEX CAD](8e32df72-3613-4ebb-bdae-13e95f2057cb.md)

[Общие положения об объектах документа T-FLEX CAD](165b92c0-a86f-470f-9ac7-467b59ccf9e7.md)

[Поиск объектов модели](b77cd316-c883-4c81-aab1-f600ecdfc183.md)