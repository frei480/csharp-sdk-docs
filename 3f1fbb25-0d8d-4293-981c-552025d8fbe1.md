

Руководство по T-FLEX CAD Open API

# Вращение
```csharp
public static void Rotation()
{
	Document document = TFlex.Application.ActiveDocument;//Получение активного документа
	document.BeginChanges("операция вращения");//Открытие блока изменений документа    

	//создание узлов
	FreeNode fn1 = new FreeNode(document, 10, 10);
	FreeNode fn2 = new FreeNode(document, 40, 30);
	FreeNode fn3 = new FreeNode(document, 70, 10);
	//соединяем их линиями    
	ConstructionOutline l1 = new ConstructionOutline(document, fn1, fn2);
	ConstructionOutline l2 = new ConstructionOutline(document, fn2, fn3);
	ConstructionOutline l3 = new ConstructionOutline(document, fn3, fn1);
	//рабочая плоскость
	StandardWorkplane swp = new StandardWorkplane(document, StandardWorkplane.StandardType.Left); 
	//профиль, построенный по эскизу
	SketchProfile sp = new SketchProfile(document);
	sp.WorkSurface = swp;//устновка поверхности, с которой берётся эскиз
	//создание 3D узла
	CoordinateNode3D node1 = new CoordinateNode3D(document); 
	node1.X = 0; node1.Y = 0; node1.Z = 0; 
	//операция вращения
	Rotation rotation = new Rotation(document);
	rotation.Profile.Add(sp.Geometry.SheetContour);//задание контура
	rotation.Angle = 180;//угол вращения

	/*ось вращения из системы координат
	PointsLCS lcs = new PointsLCS(document);//создание системы коориднат 
	lcs.PointToOrigin = node1.Geometry.Point;//начало системы коориднат
	rotation.RotationAxis = lcs.Geometry.AxisZ;//ось вращения - ось Z системы координат*/

	//ось вращения, заданная двумя точками
	CoordinateNode3D node2 = new CoordinateNode3D(document); 
	node1.X =20; node1.Y = 20; node1.Z = 0;
	rotation.FirstAxisPoint = node1.Geometry.Point;
	rotation.SecondAxisPoint = node2.Geometry.Point;

	document.EndChanges();//Закрытие блока изменений документа
}
```