

Руководство по T-FLEX CAD Open API

# Создание переменных  
        
    
    public static void Variables()
    {
        Document document = TFlex.Application.ActiveDocument;//Получение активного документа
        document.BeginChanges("Создание переменных");//Открытие блока изменений документа
    
        Variable v1 = new Variable(document, "v1", 1.7);//вещественная переменная
        Variable v2 = new Variable(document, "$v2", "123"); //текстовая переменная
        Variable v3 = new Variable(document, "v3", 2.3);
        Variable v4 = new Variable(document, "v4", "v1 + v3");//использование выражений с другими переменными
    
        foreach(Variable v in document.GetVariables())
        {
            if(v.Name == "v1")
            {
                v2.RealValue = v.RealValue;//присвоение значения переменной
            }
        }
    
        document.EndChanges();//Закрытие блока изменений документа 
    }