

Руководство по T-FLEX CAD Open API

# Копия с перемещением  
  
---  
      
    
    public static void MoveCopy()//Создание 2D-копий
    {
        Document document = TFlex.Application.ActiveDocument;//Получение активного документа
        document.BeginChanges("Копирование 2D объекта");//Открытие блока изменений документа
    
        int r1 = 50;
        int r2 = 30;
    
        FreeNode fnCenter = new FreeNode(document, 50, 700);
        FreeNode fn1 = new FreeNode(document, fnCenter.X.Value + r1, fnCenter.Y.Value);
        FreeNode fn2 = new FreeNode(document, fnCenter.X.Value, fnCenter.Y.Value + r2);
    
        EllipseConstruction ec = new EllipseConstruction(document);
        ec.SetCenterAndTwoNodes(fnCenter, fn1, fn2);//эллипс через центр и два узла
    
        MoveCopy moveCopy = new MoveCopy(document);
        moveCopy.AddSource(ec);//добавление в копию объекта (эллипса)
        moveCopy.StartNode = new FreeNode(document, 50, 700);//Начальный узел, определяющий перемещение
        moveCopy.EndNode = new FreeNode(document, 100, 800);//Конечный узел, определяющий перемещение
    
        document.EndChanges();//Закрытие блока изменений документа
    }