

Руководство по T-FLEX CAD Open API

# Слой  
```csharp
public static void Layer()//создания нового слоя на чертеже и установки его параметров
{            
	Document document = TFlex.Application.ActiveDocument;//Получение активного документа
	document.BeginChanges("Создание нового слоя");//Открытие блока изменений документа

	Layer l = new Layer(document);
	l.Monochrome = true;//одноцветный
	l.Color = 12;//цвет слоя
	l.SetLineWidth = true;

	document.EndChanges();//Закрытие блока изменений документа
}
```
```csharp
 //Пример иллюстрирующий перебор всех линий изображения и изменение их в зависимости от типа линии изображения
public static void TypeOutline()
{            
	Document document = TFlex.Application.ActiveDocument;//Получение активного документа
	document.BeginChanges("Изменение типа линий");//Открытие блока изменений документа

	Layer l1 = new Layer(document);
	l1.Name = "Основные линии";

	Layer l2 = new Layer(document);
	l2.Name = "Тонкие линии";

	Layer l3 = new Layer(document);
	l3.Name = "Осевые линии";

	foreach (Outline ol in document.GetOutlines())//цикл по линиям изображения
	{
		//назначении линии слоя "основные линии"
		if (ol.PatternName == "CONTINUOUS"){ ol.Layer = l1; }
		else if (ol.PatternName == "THIN") { ol.Layer = l2;}
		else if (ol.PatternName == "CENTER" || ol.PatternName == "CENTER2"){ ol.Layer = l3;}
	}

	document.EndChanges();//Закрытие блока изменений документа
}
```