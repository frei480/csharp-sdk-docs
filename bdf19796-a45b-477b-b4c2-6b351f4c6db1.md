

Руководство по T-FLEX CAD Open API

# Изменение свойств тела  
        
    
    public static void OperationSetParams()
    {
        Document document = TFlex.Application.ActiveDocument;//Получение активного документа
        document.BeginChanges("");    //Открытие блока изменений документа
    
        FreeNode n1 = new FreeNode(document, 1, 1); 
    
        CircleConstruction circle = new CircleConstruction (document); 
        circle.SetCenterAndRadius(n1, 10); 
    
        Area ar = new Area (document); 
        TFlex.Model.Model2D.Contour cn = ar.AppendContour(); 
    
        ConstructionContourSegment seg1 = new ConstructionContourSegment(cn); 
        seg1.Construction = circle; 
    
        StandardWorkplane swp = new StandardWorkplane(document, StandardWorkplane.StandardType.Left); 
        AreaProfile pr3D = new AreaProfile(document); 
        pr3D.Area = ar; 
        pr3D.WorkSurface = swp; 
    
        ThickenExtrusion ex = new ThickenExtrusion(document); 
    
        ex.Thickness1 = 10; 
        ex.LengthType = ThickenExtrusion.LengthValue.AutoValue; //Данный параметр должен быть выставлен! 
        ex.ForwardLength = 50; 
    
        ex.Profile.Add(pr3D.Geometry.SheetContour);
        Material m = new Material(document);
    
        m.Name = "123";
        ex.Material = m;
    
        ex.Material.Parameters.Transparency = 0.2;
        ex.Suppression.Suppress = false;
    
        ex.Color = 100;
    
        document.EndChanges();//Закрытие блока изменений документа
    }